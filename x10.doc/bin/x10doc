#!/bin/bash

# If X10_FROM_SRC is set in your environment, then
# this script will default to using paths that assume
# the standard X10 developer setup and a desire to build from source.  
# If it is not set, then the script will use paths that are 
# appropriate for a pre-built distribution of x10. 

UNAME=`uname -s`
FILE_SEP='/'; if [[ "$UNAME" = CYGWIN* ]]; then FILE_SEP='\\'; fi
PATH_SEP=':'; if [[ "$UNAME" = CYGWIN* ]]; then PATH_SEP=';'; fi

prog=$(readlink $0 2>&1)
[ $? -eq 127 -o "$prog" = "" ] && prog="$0"
TOP="$(cd "$(dirname "$prog")/.." && pwd)"
if [[ "$UNAME" = CYGWIN* ]]; then TOP="$(cygpath -aw "$TOP")"; fi

#NOTE: Hacked to assume x10doc is not installed, since
#      the dist rule is disabled.
X10=$TOP/../x10.dist
export X10SOURCES=$TOP/../x10.runtime/src-x10

# if [[ -z "$X10_FROM_SRC" ]]; then
#     # Default to pre-built distribution; do not set X10REL
#     [ -z "$X10SOURCES" ] && export X10SOURCES="$X10DIST/lib/x10.jar"
#     X10="$TOP"
# else
#     # Default to developer setup
#     [ -z "$X10REL" ] && export X10REL="../x10.dist"
#     [ -z "$X10SOURCES" ] && export X10SOURCES="$X10DIST/../x10.runtime/src-x10"
#     X10="$(cd "$TOP/$X10REL" && pwd)"
# fi



[ -z "$TOOLSJAR" ] && export TOOLSJAR="$JAVA_HOME/lib/tools.jar"


export CP_OVERRIDE="${TOP}${FILE_SEP}lib${FILE_SEP}x10c.jar${PATH_SEP}${TOP}${FILE_SEP}classes${PATH_SEP}${TOOLSJAR}${PATH_SEP}"
export DEXT="x10doc.ExtensionInfo"

exec "${X10}/bin/x10c" "$@"

